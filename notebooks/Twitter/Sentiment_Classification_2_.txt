import pandas as pd
import numpy as np

from google.colab import files
files.upload()

df = pd.read_csv("Tesla1.csv")

df

pip install unidecode

import re
import unidecode
def cleanTwt(twt):
  
    twt = str(twt)
    twt = unidecode.unidecode(twt)
    twt = re.sub('@\S', 'stock', twt)
    twt = re.sub('#Stocks', 'Stock', twt)
    twt = re.sub('#[A-Za-z0-9]+', '', twt)
    twt = re.sub('\\n', ' ' , twt)
    twt = re.sub('https?:\S+', ' ',twt )
    twt = re.sub('/W','', twt )
    twt = re.sub('\>','', twt )
    twt = re.sub(r'RT[\s]+','', twt )

    return twt

df['cleaned_tweets'] = df['text'].apply(cleanTwt)

df

#first install pretrained sentiment analyzer flair
!pip install flair

# !pip install requests~=2.23.0 
# !pip install datascience 0.10.6
# !pip install folium==0.2.1

from flair.models import TextClassifier
from flair.data import Sentence
classifier = TextClassifier.load('en-sentiment')

def classify_sentence(X):
    sentence = Sentence(X)
    classifier.predict(sentence)
    return sentence.labels
   


df["sentiment"]=df["text"].apply(classify_sentence)

df

df.to_csv("Tesla sentiment_final.csv")



